<iframe
    id          = "mfAd"
    frameborder = "0" 
    sandbox     = "allow-top-navigation allow-scripts allow-same-origin allow-popups"
    style       = "border:none;width:320px;height:50px;overflow:hidden;margin:none;scrolling:no;"
    >
</iframe>
<script>
var params = {
    r_type          : "banner",
    u               : navigator.userAgent,
    s               : "fe96717d9875b9da4339ea5367eff1ec",
    m               : "live",
    rt              : "javascript",
    v               : "3.0",
    adspace_width   : 320,
    adspace_height  : 50,
    jsvar           : "mfAd",
    o_iosadvid      : "%eudid!",
    c_mraid         : 0
}

var query = Object.keys(params).map(function(k){
    return [k,encodeURIComponent(params[k])].join("=");
}).join("&");

function noFill(){
    loaded=true;
    window.location="mopub://failLoad"; 
}

var url     = "http://my.mobfox.com/request.php?"+query,
    req = new XMLHttpRequest();

req.addEventListener("load",function(){
    var resp = this.responseText; 
    if(this.status!==200 || !resp || resp.length===0){
        return noFill();
    }
    document.querySelector("#mfAd").srcdoc = eval(resp.replace("var mfAd = ",""))[0].content;
});

req.addEventListener("error",noFill);
req.addEventListener("abort",noFill);
req.ontimeout = noFill; 
req.timeout = 1000;
req.open('GET', url, true);
req.send(null);

</script>

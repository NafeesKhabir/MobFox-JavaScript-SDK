var render_response=function(width,height,json){try{"string"==typeof json&&(json=JSON.parse(json));var ifrm=document.createElement("iframe");ifrm.id="mobfoxFrame",document.body.appendChild(ifrm),ifrm.frameborder="0",ifrm.style.border="none",ifrm.style.width=width+"px",ifrm.style.height=height+"px",ifrm.style.overflow="hidden",ifrm.style.margin="none",ifrm.setAttribute("scrolling","no");var html=getHTML(json);html.indexOf("<html>")<0?html=["<html><body style='margin:0px;padding:0px;'>",html,"</body></html>"].join("\n"):html+="<style>body{margin:0px;padding:0px}</style>",ifrm.onload=function(){successLoad(window)};var c=ifrm.contentWindow||ifrm.contentDocument.document||ifrm.contentDocument;c.document.open(),c.document.write(html),c.document.close()}catch(e){failLoad(window,e)}},getHTML=function(json){var html=json.request.htmlString,markupRegExp=new RegExp(/var markupB64\s*=\s*[\"\'](.*?)[\"\']/m),matchMarkup=json.request.htmlString.match(markupRegExp);return matchMarkup&&(html=window.atob(matchMarkup[1])),html},failLoad=function(window,reason){try{window.webkit.messageHandlers.mobfox.postMessage({fail:reason})}catch(e){}},successLoad=function(window){try{window.webkit.messageHandlers.mobfox.postMessage({success:""})}catch(e){}};
